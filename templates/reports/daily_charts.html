{% extends 'base.html' %}

{% block content %}
    {% load static %}
    <style>
        .elementor-divider {
            padding-top: 20px;
            padding-bottom: 15px;
        }

        hr {
            height: 2.5px;
            background-color: #ff0000;
            border: none;
        }
    </style>


    <img class="mt-4" width="100%" src="{% static 'dist/img/client-page-header.png' %}">

    <div class="elementor-divider"></div>
    <hr>
    <div class="elementor-divider"></div>
    <h4 style="text-align: center; color: red;"><b id="rep_head">Daily Analysis Report</b></h4>
    <div class="elementor-divider"></div>
    <div style="margin-left: 30%; margin-right: 30%">
      <form  id="filterform" method="POST" enctype="multipart/form-data">
      {% csrf_token %}
         <div class="col-auto my-1">
          <label style="margin-left: 160px;" >Change Preference</label>
          <select class="custom-select dailyfilter mr-sm-2" id="selectbox" name="sel_val">
            <option value="1">Daily</option>
            <option value="2">Weekly</option>
            <option value="3">Monthly</option>
            <option value="4">Yearly</option>
          </select>
        </div>
      </form>
    </div>
    <div class="elementor-divider"></div>
    <div class="elementor-divider"></div>
    <div class="elementor-divider"></div>
    <div class="row">

        <div class="col-md-4"><canvas id="chart1"></canvas></div>
        <div class="col-md-4"><canvas id="chart2"></canvas></div>
         <div class="col-md-4"><canvas id="chart3"></canvas></div>

        <div class="col-md-4"><canvas id="chart4"></canvas></div>
        <div class="col-md-4"><canvas id="chart5"></canvas></div>
        <div class="col-md-4"><canvas id="chart6"></canvas></div>

        <div class="col-md-3"></div>
        <div class="col-md-6"><canvas id="chart7"></canvas></div>
    </div>

    <div class="elementor-divider"></div>
    <div class="elementor-divider"></div>
    <hr style="background-color: black; height: 1px;">
    <div class="elementor-divider"></div>
    <a href="https://uxlivinglab.com/" class="elementor-button-link elementor-button elementor-size-sm" role="button">
        <h6 style="text-align: center; color: black; opacity: 0.6"><b> Visit uxlivinglab</b></h6>
    </a>
    <div class="elementor-divider"></div>

    <div class="row text-center">
        <div class="col-12">
            <img class="img-responsive" style="margin:0 auto;" src="{% static 'dist/img/logo-sm.png' %}"/>
        </div>
    </div>
    <div class="elementor-divider"></div>
    <h6 style="text-align: center; color: red;"><b>uxlivinglab - innovating from people's minds</b></h6>
    <div class="elementor-divider"></div>
    <div class="elementor-divider"></div>
    <hr style="background-color: black; height: 1px;">


{% endblock content %}

{% block custom_js %}
    <script type="module">
            $(document).ready(function () {
            var ctx1 = document.getElementById('chart1');
            var myChart1 = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: {{report_date|safe}},
                    datasets: [{
                        label: 'Brand Awareness',
                        data: {{ brand_awareness |safe}},
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                        ],
                        pointColor: [
                            'rgba(255, 99, 132, 1)',
                        ],
                        borderWidth: 3,
                        pointRadius: 5,
                    }]
                },
                options: {
                    scales: {
                         x: {
                            ticks: {
                               minRotation: 0,
                               maxRotation: 0
                            }
                          },
                        y: {
                            beginAtZero: true
                        },

                    }
                }
            });

            var ctx2 = document.getElementById('chart2');
            var myChart2 = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: {{report_date|safe}},
                    datasets: [{
                        label: 'Choices on purchase',
                        data: {{purchase_choices|safe}},
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.2)',
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                        ],
                        pointColor: [
                            'rgba(255, 99, 132, 1)',
                        ],
                        borderWidth: 3,
                        pointRadius: 5,
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        },

                    }
                }
            });

            var ctx3 = document.getElementById('chart3');
            var myChart3 = new Chart(ctx3, {
                type: 'line',
                data: {
                    labels: {{report_date|safe}},
                    datasets: [{
                        label: 'Brand Loyalty',
                        data: {{brand_loyalty}},
                        backgroundColor: [
                            'rgba(255, 206, 86, 0.2)',
                        ],
                        borderColor: [
                            'rgba(255, 206, 86, 1)',
                        ],
                        pointColor: [
                            'rgba(255, 99, 132, 1)',
                        ],
                        borderWidth: 3,
                        pointRadius: 5,
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        },

                    }
                }
            });

            var ctx4 = document.getElementById('chart4');
            var myChart4 = new Chart(ctx4, {
                type: 'line',
                data: {
                    labels: {{report_date|safe}},
                    datasets: [{
                        label: 'Net Promotor Score',
                        data: {{net_promotor_score |safe}},
                        backgroundColor: [
                            'rgba(75, 192, 192, 0.2)',
                        ],
                        borderColor: [
                            'rgba(75, 192, 192, 1)',
                        ],
                        pointColor: [
                            'rgba(255, 99, 132, 1)',
                        ],
                        borderWidth: 3,
                        pointRadius: 5,
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        },

                    }
                }
            });

            var ctx5= document.getElementById('chart5');
            var myChart5 = new Chart(ctx5, {
                type: 'line',
                data: {
                    labels: {{report_date|safe}},
                    datasets: [{
                        label: 'QR Code Scans',
                        data: {{qr_scans|safe}},
                        backgroundColor: [
                            'rgba(153, 102, 255, 0.2)',
                        ],
                        borderColor: [
                            'rgba(153, 102, 255, 1)',
                        ],
                        pointColor: [
                            'rgba(255, 99, 132, 1)',
                        ],
                        borderWidth: 3,
                        pointRadius: 5,
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        },

                    }
                }
            });

            var ctx6= document.getElementById('chart6');
            var myChart6 = new Chart(ctx6, {
                type: 'line',
                data: {
                    labels: {{report_date|safe}},
                    datasets: [{
                        label: 'Incomplete Responses',
                        data: {{incomplete_responses|safe}},
                        backgroundColor: [
                            'rgba(255, 159, 64,0.2)',
                        ],
                        borderColor: [
                            'rgba(255, 159, 64, 1)',
                        ],
                        pointColor: [
                            'rgba(255, 99, 132, 1)',
                        ],
                        borderWidth: 3,
                        pointRadius: 5,
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        },

                    }
                }
            });

            var ctx7 = document.getElementById('chart7');
            var myChart7 = new Chart(ctx7, {
                type: 'line',
                data: {
                    labels: {{report_date|safe}},
                    datasets: [{
                        label: 'Completed Responses',
                        data: {{completed_responses|safe}},
                        backgroundColor: [
                            'rgba(255, 159, 74, 0.2)',
                        ],
                        borderColor: [
                            'rgba(255, 159, 74, 1)',
                        ],
                        pointColor: [
                            'rgba(255, 159, 74, 1)',
                        ],
                        borderWidth: 3,
                        pointRadius: 5,
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        },

                    }
                }
            });

            $("#selectbox").on('change', function(){
                // var value = $(".dailyfilter").val()
                $.ajax({
                url: 'daily_charts',
                method: 'POST',
                data: $('#filterform').serialize(),
                dataType: 'json',
                success: function (context) {

                  $("#rep_head").html(context.title);


                  myChart1.data.labels = context.report_date;
                  myChart1.data.datasets[0].data = context.brand_awareness;
                  myChart1.update();

                  myChart2.data.labels = context.report_date;
                  myChart2.data.datasets[0].data = context.purchase_choices;
                  myChart2.update();

                  myChart3.data.labels = context.report_date;
                  myChart3.data.datasets[0].data = context.brand_loyalty;
                  myChart3.update();

                  myChart4.data.labels = context.report_date;
                  myChart4.data.datasets[0].data = context.net_promotor_score;
                  myChart4.update();

                  myChart5.data.labels = context.report_date;
                  myChart5.data.datasets[0].data = context.qr_scans;
                  myChart5.update();

                  myChart6.data.labels = context.report_date;
                  myChart6.data.datasets[0].data = context.incomplete_responses;
                  myChart6.update();

                  myChart7.data.labels = context.report_date;
                  myChart7.data.datasets[0].data = context.completed_responses;
                  myChart7.update();


                }
              });
            });


        })
    </script>

{% endblock custom_js %}